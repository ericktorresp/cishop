{include file="pageheader.html"}
<form method="POST" name="listForm" action="./?controller=firewall&action={$form_action}"  
onsubmit="return validate()" >
<div class="tab-div">
  <div id="tabbar-div"><span 
	class="tab-front" id="general-tab">基础设置</span><span 
	 class="tab-back" id="detail-tab">菜单限制</span>
  </div>

{* 标签 : 基础设置 *}
  <div id="tabbody-div">
    <table width="90%" id="general-table">
	  <tr>
        <td class="narrow-label">行为名称</td>
        <td>
			<input size=40 name="actionname" value="{if $form_action==updateaction}{$d.actionname|escape:html}{/if}" type="text"></td>
      </tr>

	  <tr>
        <td class="narrow-label">消息至用户</td>
		 <td>
<label for="msgtouser"><input type="checkbox" name="msgtouser" id="msgtouser" value="1" 
{if $d.msgtouser}checked="checked"{/if}>发送</label>&nbsp;&nbsp;&nbsp;
内容: <input style='background-color:#eaeaea;' size=46 name="messagetouser" value="{if $form_action==updateaction}{$d.messagetouser|escape:html}{/if}" type="text">
		</td>
      </tr>

	  <tr>
        <td class="narrow-label">消息至管理员</td>
		 <td>
<label for="msgtoadmin"><input type="checkbox" name="msgtoadmin" id="msgtoadmin" value="1" 
{if $d.msgtoadmin}checked="checked"{/if}>发送</label>&nbsp;&nbsp;&nbsp;
内容: <input style='background-color:#eaeaea;' size=46 name="messagetoadmin" value="{if $form_action==updateaction}{$d.messagetoadmin|escape:html}{/if}" type="text">
		</td>
      </tr>

	    <tr>
        <td class="narrow-label">使用函数名</td>
        <td>
			<input size=16 name="functionname" value="{$d.functionname|escape:html}" type="text"> <a href="javascript:showNotice('noticeSort');" title="排序值"><img src="./images/notice.gif" width="16" height="16" border="0"/></a><span class="notice-span" id="noticeSort">预留:函数名帮助信息</span>
		</td>
      </tr>

	  <tr>
        <td class="narrow-label">
		 函数参数</td>
        <td><input size=16 name="functionargs" value="{$d.functionargs|escape:html}" type="text">
		</td>
      </tr>

	  <tr>
        <td class="narrow-label">函数描述</td>
        <td><input size=40 name="functiondesc" value="{$d.functiondesc|escape:html}" type="text"></td>
      </tr>

	  <tr>
        <td class="narrow-label">中断程序</td>
        <td><select style='width:100px;' name="isexit">
			   <option style='color:#f30;' value="1" {if $d.isexit==1}selected=TRUE{/if}>中断程序</option>
			   <option style='color:#690;' value="0" {if $d.isexit!=1}selected=TRUE{/if}>继续运行</option>
			</select></td>
      </tr>

	  <tr>
        <td class="narrow-label">是否启用</td>
        <td><select style='width:100px;' name="isdisabled">
			   <option style='color:#690;' value="0" {if $d.isdisabled==0}selected=TRUE{/if}>正常</option>
			   <option style='color:#f30;' value="1" {if $d.isdisabled!=0}selected=TRUE{/if}>禁用</option>
			</select></td>
      </tr>
    </table>


{* 标签 : 权限属性 *}
<div class="list-div">
<table cellspacing='1' cellpadding='2' id="detail-table" style="display:none">
<tr>{foreach from=$menus.0 item=menu key=top}
	<td rowspan="{$counts.$top}"  class="first-cell" style='width:16%;'><label for="menu_{$top}"><input type="checkbox" 
	name="menustrs[]" id="menu_{$top}" value="{$top}" {if $menu.check}checked="checked"{/if}>{$menu.title}</label></td>
	{if isset($menus.$top)}
	{foreach from=$menus.$top item=menu2 key=top2}
		<td width="15%" style='padding-left:6px;'><label for="menu_{$top2}"><input type="checkbox" name="menustrs[]" id="menu_{$top2}" value="{$top2}" {if $menu2.check}checked="checked"{/if} >{$menu2.title}</label></td>
		<td style="width:69%;line-height:18px;padding-left:12px;">
		{if count($menus.$top2)>0}
			{foreach from=$menus.$top2 item=menu3 key=top3}<div style="width:160px;float:left;"><label for="menu_{$top3}"><input type="checkbox" name="menustrs[]" id="menu_{$top3}" value="{$top3}"{if $menu3.check}checked="checked"{/if} >{$menu3.title}</label></div>{/foreach}
		{else}
		&nbsp;
		{/if}
		</td>
</tr>{/foreach}{else}<td></td><td></td></tr>{/if}
{/foreach} 
</table></div>

<div class="button-div"><br/>
<input type="submit" value="提交" class="button"  />
<input type="reset" value="重置" class="button" />
<input type="hidden" name="actionid" value='{$d.id}'>
    </div>
  </div>

</div>
</form>


<script language="JavaScript">
{literal}
document.getElementById("tabbar-div").onmouseover = function(e)
{
    var obj = Utils.srcElement(e);
    if (obj.className == "tab-back")
    {
        obj.className = "tab-hover";
    }
}

document.getElementById("tabbar-div").onmouseout = function(e)
{
    var obj = Utils.srcElement(e);
    if (obj.className == "tab-hover")
    {
        obj.className = "tab-back";
    }
}

document.getElementById("tabbar-div").onclick = function(e)
{
    var obj = Utils.srcElement(e);
	//alert(obj.className);
    if (obj.className=='' || obj.className == "tab-front")
    {
        return;
    }
    else
    {
        objTable = obj.id.substring(0, obj.id.lastIndexOf("-")) + "-table";

        var tables = document.getElementsByTagName("table");
        var spans  = document.getElementsByTagName("span");

        for (i = 0; i < tables.length; i++)
        {
            if (tables[i].id == objTable)
            {
                tables[i].style.display = (Browser.isIE) ? "block" : "table";
            }
            else
            {
                tables[i].style.display = "none";
            }
        }
        for (i = 0; spans.length; i++)
        {
            if (spans[i].className != null && spans[i].className == "tab-front")
            {
                spans[i].className = "tab-back";
                obj.className = "tab-front";
                break;
            }
        }
    }
}

function showNotice(objId)
{
    var obj = document.getElementById(objId);

    if (obj)
    {
        if (obj.style.display != "block")
        {
            obj.style.display = "block";
        }
        else
        {
            obj.style.display = "none";
        }
    }
}
function checkAll(frm, checkbox)
{
  for (i = 0; i < frm.elements.length; i++)
  {
    if (frm.elements[i].name == 'action_code[]' || frm.elements[i].name == 'chkGroup')
    {
      frm.elements[i].checked = checkbox.checked;
    }
  }
}

function check(list, obj)
{
  var frm = obj.form;

    for (i = 0; i < frm.elements.length; i++)
    {
      if (frm.elements[i].name == "action_code[]")
      {
          var regx = new RegExp(frm.elements[i].value + "(?!_)", "i");

          if (list.search(regx) > -1) frm.elements[i].checked = obj.checked;
      }
    }
}
{/literal}
</script>

{insert_scripts files="./js/validator.js"}
{literal}
<script language="JavaScript">
<!--
  /**
   * 检查表单输入的内容
   */
	function validate()
	{
		var validator = new Validator('listForm');
		validator.required('actionname', "分组名不能为空!");
		return validator.passed();  
    }
//-->
</script>
{/literal}

{include file="pagefooter.html"}