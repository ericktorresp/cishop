{include file="pageheader.html"}
<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/calendar/jquery.dyndatetime.js"></script>
<script type="text/javascript" src="./js/calendar/lang/calendar-utf8.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="./js/calendar/css/calendar-blue2.css"  />
{literal}
<script type="text/javascript">
//复制内容到剪贴板
function copyToClipboard(obj)
{
	txt = jQuery("#"+obj).html();
	if(window.clipboardData) 
	{
		window.clipboardData.clearData();
		window.clipboardData.setData("Text", txt);
	}
	else if(navigator.userAgent.indexOf("Opera") != -1) 
	{
		window.location = txt;
	} 
	else if (window.netscape) 
	{
		try 
		{
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		} 
		catch (e) 
		{
			alert("您的firefox安全限制限制您进行剪贴板操作，请在地址栏中输入“about:config”将“signed.applets.codebase_principal_support”设置为“true”之后重试");
			return false;
		}
		var clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);
		if (!clip)
		return;
		var trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);
		if (!trans)
		return;
		trans.addDataFlavor('text/unicode');
		var str = new Object();
		var len = new Object();
		var str = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
		var copytext = txt;
		str.data = copytext;
		trans.setTransferData("text/unicode",str,copytext.length*2);
		var clipid = Components.interfaces.nsIClipboard;
		if (!clip)
		return false;
		clip.setData(trans,null,clipid.kGlobalClipboard);
	}else{
		alert("你的浏览器暂时不支持此功能，建议使用Firefox");
		return false;
	}
	alert('复制成功!');
}

	jQuery(document).ready(function() {
		jQuery("#sdate").dynDateTime({
			ifFormat: "%Y-%m-%d %H:%M",
			daFormat: "%l;%M %p, %e %m,  %Y",
			align: "Br",
			electric: true,
			singleClick: false,
			button: ".next()", //next sibling
			showOthers: true,
			weekNumbers: true,
			//onUpdate: function(){alert('1');}
			showsTime: true
		});
		jQuery("#sdate").change(function(){
			if(! validateInputDate(jQuery("#sdate").val()) )
			{jQuery("#sdate").val('');alert("时间格式不正确,正确的格式为:2009-06-10 10:59");}
		});
		jQuery("#edate").dynDateTime({
			ifFormat: "%Y-%m-%d %H:%M",
			daFormat: "%l;%M %p, %e %m,  %Y",
			align: "Br",
			electric: true,
			singleClick: false,
			button: ".next()", //next sibling
			showOthers: true,
			weekNumbers: true,
			//onUpdate: function(){alert('1');}
			showsTime: true
		});
		jQuery("#edate").change(function(){
			if(! validateInputDate(jQuery("#edate").val()) )
			{jQuery("#edate").val('');alert("时间格式不正确,正确的格式为:2009-06-10 10:59");}
		});
		jQuery("#sdate2").dynDateTime({
			ifFormat: "%Y-%m-%d %H:%M",
			daFormat: "%l;%M %p, %e %m,  %Y",
			align: "Br",
			electric: true,
			singleClick: false,
			button: ".next()", //next sibling
			showOthers: true,
			weekNumbers: true,
			//onUpdate: function(){alert('1');}
			showsTime: true
		});
		jQuery("#sdate2").change(function(){
			if(! validateInputDate(jQuery("#sdate2").val()) )
			{jQuery("#sdate2").val('');alert("时间格式不正确,正确的格式为:2009-06-10 10:59");}
		});
		jQuery("#edate2").dynDateTime({
			ifFormat: "%Y-%m-%d %H:%M",
			daFormat: "%l;%M %p, %e %m,  %Y",
			align: "Br",
			electric: true,
			singleClick: false,
			button: ".next()", //next sibling
			showOthers: true,
			weekNumbers: true,
			//onUpdate: function(){alert('1');}
			showsTime: true
		});
		jQuery("#edate2").change(function(){
			if(! validateInputDate(jQuery("#edate2").val()) )
			{jQuery("#edate2").val('');alert("时间格式不正确,正确的格式为:2009-06-10 10:59");}
		});
	});


var seconds = {$sSysAutoReflushSec|default:60};
{literal}
onload = function()
{
	window.setInterval(redirection, 1000);
}

function redirection()
{
	seconds --;
	document.title = '[{$sSysTopMessage}]['+seconds+'] PassPort 后台管理 {$ur_here}';
}
</script>
{/literal}

<div class="form-div">
    <FORM name="searchForm" action="" METHOD='get'>
    <input type='hidden' name="controller" value="report"/>
    <input type='hidden' name="action" value="withdrawel"/>
    <img src="./images/icon_search.gif" width="26" height="22" border="0" TITLE="SEARCH" />
处理状态: <select name="status">
<option value="-1" {if $s.st=='-1'}SELECTED{/if}>全部</option>
<option value="0" {if $s.st=='0'}SELECTED{/if}>未处理</option>
<option value="3" {if $s.st=='3'}SELECTED{/if}>已操作</option>
<option value="1" {if $s.st=='1'}SELECTED{/if}>提现失败</option>
<option value="2" {if $s.st=='2'}SELECTED{/if}>提现成功</option>
<option value="5" {if $s.st=='5'}SELECTED{/if}>操作中</option>
</select> &nbsp;&nbsp;&nbsp;&nbsp;

处理管理员: <input type="text" name="adminname" size='18' value='{$s.adminname|escape:html}' />
&nbsp;&nbsp;&nbsp;
网络地址: <input type="text" name="ipaddr" size='18' value='{$s.ipaddr|escape:html}' />
&nbsp;&nbsp;&nbsp;
用户身份：<select name="identity">
<option value="-1">全部</option>
<option value="1" {if $s.identity=='1'}SELECTED{/if}>普通用户</option>
<option value="2" {if $s.identity=='2'}SELECTED{/if}>VIP</option>
<option value="3" {if $s.identity=='3'}SELECTED{/if}>黑名单</option>
</select>
<div style='padding: 5px 20px 2px 29px;'>
<font color='red'>提现发起</font>时间起始于: <input type="text" id="sdate" name="sdate" size='17' value='{$s.sdate|escape:html}' /> <img src="./images/calendar2.gif"> &nbsp; 至 &nbsp; 
<input type="text"id="edate" name="edate"  size='17' value='{$s.edate|escape:html}' /> <img src="./images/calendar2.gif" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
提现用户: <input type="text" name="username" size='15' value='{$s.username|escape:html}' />
&nbsp;&nbsp;&nbsp;
提现银行：<select name="bank" id="bank">
    <option value="">请选择...</option>
    {foreach from=$banklist item=bank key=k}
    	<option value="{$bank.bank_name}" {if $s.bank == $bank.bank_name}selected{/if}>{$bank.bank_name}</option>
    {/foreach}
</select>
<br/>

<font color='blue'>提现处理</font>时间起始于: <input type="text" id="sdate2" name="sdate2" size='17' value='{$s.sdate2|escape:html}' /> <img src="./images/calendar2.gif"> &nbsp; 至 &nbsp; 
<input type="text"id="edate2" name="edate2"  size='17' value='{$s.edate2|escape:html}' /> <img src="./images/calendar2.gif" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
总&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;代 : <input type="text" name="tproxyname" size='15' value='{$s.tproxyname|escape:html}' />
&nbsp;&nbsp;&nbsp;&nbsp;<input type="submit" value="搜 索" class="button" /> <a href="javascript:showNotice('noticeSearch');" title="帮助信息"><img src="./images/notice.gif" width="16" height="16" border="0" title="帮助信息"></a>
<span class="notice-span" style='line-height:18px;padding:8px 0px 2px 20px;color:#669900' 
id="noticeSearch">只有网络地址模糊搜索,例: <b><font color=red>192.168*</font></b><br/>
用户名,总代名,管理员名必须严格匹配, 例: <b><font color=red>Dummy</font></b></span>
</div>
  </FORM>
</div>
<div class="list-div" id="listDiv">

<form method="POST" name="listForm" action='./?controller=adminuser&action=edit' onsubmit="return confirmSubmit(this)">
<table cellspacing='1' cellpadding='3' id='list-table'>
  <tr>
    <th>ID</th>
	<th>状态</th>
	<th>银行</th>
    <th>提现用户</th>
    <th>总代</th>
	<th>提现金额</th>
    <th>申请提现时间</th>
    <th>用户身份</th>
    <th>处理开始时间</th>
    <th>处理结束时间</th>
    <th>管理员</th>
    <th>操作</th>
  </tr>

{foreach from=$aUserList item=list key=k1}
  <tr>
    <td class="first-cell">{$list.entry}</td>
	<td align="center">
        {$astatus.$list.status}
	</td>
	<td align="center">{$list.bankname|escape:html}</td>
	<td align="center">{$list.sendername|escape:html}</td>
	<td align="center">{$list.proxyname|escape:html}</td>
	<td align="right">{$list.amount|escape:money}</td>
	<td align="center">{$list.accepttime|escape:html}</td>
	<td align="center">{if $list.identity == 1}---{elseif $list.identity == 2}VIP{else}黑名单{/if}</td>
	<td align="center">{if $list.pay_time!=0}{$list.pay_time}{else}<font color='#c0c0c0'>-----</font>{/if}</td>
	<td align="center">{if $list.finishtime!=0}{$list.finishtime}{else}<font color='#c0c0c0'>-----</font>{/if}</td>
	<td align="center">{if $list.adminid!=0}{$list.opname|escape:html}{else}<font color='#c0c0c0'>-----</font>{/if}</td>
	<td align="center">
<div id='h_{$list.entry}' style='display:none'>
<textarea name="copy_{$list.entry}" id="copy_{$list.entry}" style="display:none;">
提现发起 : {$list.sendername|escape:html}

所属总代 : {$list.proxyname|escape:html}

银行名称 : {$list.bankname|escape:html}

银行卡号 : {$list.bankcard|escape:html}

所属省份 : {$list.province|escape:html}

真实姓名 : {$list.realname|escape:html}

提现金额 : {$list.amount|escape:money}

发起时间 : {$list.accepttime|escape:html}

处理时间 : {if $list.finishtime!=0}{$list.finishtime}{else}未处理{/if}
</textarea>
</div>
{if $list.status == 0}<a href="./?controller=report&action=dealwithdraw&id={$list.entry}" TITLE='出纳汇款' >{if $list.dealing_user_id > 0}{$list.dealing_user_name}正在处理{else}出纳汇款{/if}</a>&nbsp;&nbsp;&nbsp;{/if}
{if $list.manoperate == 1}<a href="./?controller=report&action=dealwithdraw&id={$list.entry}" title="人工介入: ID={$list.entry}">人工介入</a>{elseif $list.manoperate == 2}暂不可操作...{/if}
{if $list.status == 3}<a href="./?controller=report&action=withdraweledit&id={$list.entry}" title="会计复核: ID={$list.entry}">会计复核</a>{/if}
{if $list.status == 1 || $list.status == 2}<a href="./?controller=report&action=viewwithdraw&id={$list.entry}" title="会计复核: ID={$list.entry}">详情</a>{/if}
</td>
  </tr>
{foreachelse}
    <tr><td class="no-records" colspan="11">无相关数据</td></tr>
{/foreach}
  <tr>
    <td colspan="2"></td>
    <td align="right" nowrap="true" colspan="10">&nbsp;</td>
  </tr>
</table>

<table id="page-table" cellspacing="0"><tr><td align="right" nowrap="true">
<div style='padding-right:30px; padding-top:6px;'>{$pages}</div></td></tr></table>

</form>
</div>


{literal}
<script language="JavaScript">
function showNotice(objId)
{
    var obj = document.getElementById(objId);

    if (obj)
    {
        if (obj.style.display != "block")
        {
            obj.style.display = "block";
        }
        else
        {
            obj.style.display = "none";
        }
    }
}
if (document.getElementById("listDiv"))
{
  document.getElementById("listDiv").onmouseover = function(e)
  {
    obj = Utils.srcElement(e);

    if (obj)
    {
      if (obj.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode;
      else if (obj.parentNode.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode.parentNode;
      else return;

      for (i = 0; i < row.cells.length; i++)
      {
        if (row.cells[i].tagName != "TH") row.cells[i].style.backgroundColor = '#EEF8F9';
      }
    }

  }

  document.getElementById("listDiv").onmouseout = function(e)
  {
    obj = Utils.srcElement(e);

    if (obj)
    {
      if (obj.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode;
      else if (obj.parentNode.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode.parentNode;
      else return;

      for (i = 0; i < row.cells.length; i++)
      {
          if (row.cells[i].tagName != "TH") row.cells[i].style.backgroundColor = '#FFF';
      }
    }
  }
}
</script>
{/literal}
{include file="pagefooter.html"}