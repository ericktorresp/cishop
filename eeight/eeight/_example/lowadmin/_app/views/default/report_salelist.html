{include file="pageheader.html"}
<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/calendar/jquery.dyndatetime.js"></script>
<script type="text/javascript" src="./js/calendar/lang/calendar-utf8.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="./js/calendar/css/calendar-blue2.css"  />
<script>
$(document).ready(function(){
	jQuery("#starttime").dynDateTime({
		ifFormat: "%Y-%m-%d %H:%M:00",
		daFormat: "%l;%M %p, %e %m,  %Y",
		align: "Br",
		electric: true,
		singleClick: false,
		button: ".next()", //next sibling
		showOthers: true,
		weekNumbers: true,
		//onUpdate: function(){alert('1');}
		showsTime: true
	});
	jQuery("#starttime").change(function(){
		if(! validateInputDate(jQuery("#sdate").val()) )
		{jQuery("#starttime").val('');alert("时间格式不正确,正确的格式为:2009-06-10 10:59");}
	});
	jQuery("#endtime").dynDateTime({
		ifFormat: "%Y-%m-%d %H:%M:00",
		daFormat: "%l;%M %p, %e %m,  %Y",
		align: "Br",
		electric: true,
		singleClick: false,
		button: ".next()", //next sibling
		showOthers: true,
		weekNumbers: true,
		showsTime: true
	});
	jQuery("#endtime").change(function(){
		if(! validateInputDate(jQuery("#edate").val()) )
		{jQuery("#endtime").val('');alert("时间格式不正确,正确的格式为:2009-06-10 10:59");}
	});
	$("#lottery").change(function(){
		var methods = {$data_method};
		i = $("#lottery").val();
		$("#gamelist").html("");
		if(i>0){			
			shtml = "玩法:<select name='methodid' id='methodid'><option value='0'>所有玩法</option>";
			$.each(methods[i],function(t,k){
				shtml = shtml+"<option value='"+t+"'>"+k+"</option>";	
			});
			shtml = shtml+"</select>";
			$("#gamelist").append(shtml);
		}
		else
		{
			shtml = "玩法:<select name='methodid' id='methodid'><option value='0'>所有玩法</option></select>";
			$("#gamelist").append(shtml);
		}
	});
	$("#lottery").val({$s.lottery});
	$("#lottery").change();
	$("#methodid").val({$s.methodid|default:0});
});
</script>
<div class="form-div">
<form method="GET" action="">
<input type="hidden" name="controller" value="report">
<input type="hidden" name="action" value="salelist">
<input type="hidden" name="userid" value="{$s.userid}">
<img src="./images/icon_search.gif">
&nbsp;&nbsp;日期：
<input type="text" name="starttime" id="starttime" value="{$s.starttime|escape:html}"><img src="./images/calendar2.gif">
&nbsp;&nbsp;&nbsp;&nbsp;
<input type="text" name="endtime" id="endtime" value="{$s.endtime|escape:html}"><img src="./images/calendar2.gif">
<div style="line-height:8px;">&nbsp;</div>
<span style="padding:5px 5px 0 34px;">游戏名称:</span>
<select name="lottery" id="lottery">
<option value="0">所有游戏</option>
{foreach from=$lottery item=l key=k}
<option value="{$k}">{$l}</option>
{/foreach}
</select>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id="gamelist">
</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
代理:<select name="proxy">
<option value="0">所有</option>
{foreach from=$proxy key=k item=v}
<option value="{$v.userid}" {if $v.userid==$s.proxy}selected{/if}>{$v.username}</option>
{/foreach}
</select>
<div style="line-height:8px;">&nbsp;</div>
<span style="padding:0 5px 0 34px;">是否是测试账号</span>
<select name="istester">
<option value="-1" {if $s.istester=='-1'}SELECTED{/if}>全部类型</option>
<option value="0" {if $s.istester=='0'}SELECTED{/if}>非测试账号</option>
<option value="1" {if $s.istester=='1'}SELECTED{/if}>测试账号</option>
</select>
<span style="padding:0 5px 0 20px;">是否是冻结账号</span>
<select name="isfrozen">
<option value="-1" {if $s.isfrozen=='-1'}SELECTED{/if}>全部类型</option>
<option value="0" {if $s.isfrozen=='0'}SELECTED{/if}>非冻结账号</option>
<option value="1" {if $s.isfrozen=='1'}SELECTED{/if}>冻结账号</option>
</select>
&nbsp; &nbsp; 
<input type="submit" value="立即搜索" class="button">
</form>
</div>
<div class="list-div" id="listDiv">
<table>
<tr>
<th width="10%">用户名</th>
<th width="10%">所属组</th>
<th width="12%">总代购费</th>
<th width="12%">总返点</th>
<th width="12%">实际总代购费</th>
<th width="12%">中奖金额</th>
<th width="12%">总结算</th>
<th width="20%">操作</th>
</tr>
{if isset($self)}
<tr align="center" style="color:red;">
<td>{$self.username}</td>
<td>{if $self.usertype==1}代理{else}用户{/if}</td>
<td>{$self.sum_prize|escape:money}</td>
<td>{$self.sum_point|escape:money}</td>
<td>{$self.real_prize|escape:money}</td>
<td>{$self.sum_bonus|escape:money}</td>
<td>{$self.sum_total|escape:money}</td>
<td></td>
</tr>
{/if}
{foreach from=$aUser item=user key=k}
<tr align="center">
<td>{$user.username}</td>
<td>{if $user.usertype==1}代理{else}用户{/if}</td>
<td>{$user.sum_prize|escape:money}</td>
<td>{$user.sum_point|escape:money}</td>
<td>{$user.real_prize|escape:money}</td>
<td>{$user.sum_bonus|escape:money}</td>
<td>{$user.sum_total|escape:money}</td>
<td><a href="./index.php?controller=report&action=saledetail&userid={$k}&starttime={$s.starttime}&endtime={$s.endtime}" target="_blank">游戏明细</a>
<a href="./index.php?controller=report&action=salelist&userid={$k}&starttime={$s.starttime}&endtime={$s.endtime}">查看下级</a></td>
</tr>
{/foreach}
<tr align="center">
<td colspan="2">合计</td>
<td>{$total.sum_prize|escape:money}</td>
<td>{$total.sum_point|escape:money}</td>
<td>{$total.real_prize|escape:money}</td>
<td>{$total.sum_bonus|escape:money}</td>
<td>{$total.sum_total|escape:money}</td>
<td></td>
</tr>

</table>
</div>
<script language="JavaScript">
function showNotice(objId)
{
    var obj = document.getElementById(objId);

    if (obj)
    {
        if (obj.style.display != "block")
        {
            obj.style.display = "block";
        }
        else
        {
            obj.style.display = "none";
        }
    }
}
if (document.getElementById("listDiv"))
{
  document.getElementById("listDiv").onmouseover = function(e)
  {
    obj = Utils.srcElement(e);

    if (obj)
    {
      if (obj.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode;
      else if (obj.parentNode.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode.parentNode;
      else return;

      for (i = 0; i < row.cells.length; i++)
      {
        if (row.cells[i].tagName != "TH") row.cells[i].style.backgroundColor = '#E8F5F7';
      }
    }

  }

  document.getElementById("listDiv").onmouseout = function(e)
  {
    obj = Utils.srcElement(e);

    if (obj)
    {
      if (obj.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode;
      else if (obj.parentNode.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode.parentNode;
      else return;

      for (i = 0; i < row.cells.length; i++)
      {
          if (row.cells[i].tagName != "TH") row.cells[i].style.backgroundColor = '#FFF';
      }
    }
  }
}
</script>
{include file="pagefooter.html"}