{include file="pageheader.html"}
<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/calendar/jquery.dyndatetime.js"></script>
<script type="text/javascript" src="./js/calendar/lang/calendar-utf8.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="./js/calendar/css/calendar-blue2.css"  />
<script type="text/javascript">
	jQuery(document).ready(function() {
		jQuery("#sdate").dynDateTime({
			ifFormat: "%Y-%m-%d %H:%M",
			daFormat: "%l;%M %p, %e %m,  %Y",
			align: "Br",
			electric: true,
			singleClick: false,
			button: ".next()", //next sibling
			showOthers: true,
			weekNumbers: true,
			//onUpdate: function(){alert('1');}
			showsTime: true
		});
		jQuery("#sdate").change(function(){
			if(!validateInputDate(jQuery("#sdate").val()))
			{
				jQuery("#sdate").val('{$s.sdate|escape:html}');
				alert("时间格式不正确,正确的格式为:2009-06-10 10:59");
			}
		});
		jQuery("#edate").dynDateTime({
			ifFormat: "%Y-%m-%d %H:%M",
			daFormat: "%l;%M %p, %e %m,  %Y",
			align: "Br",
			electric: true,
			singleClick: false,
			button: ".next()", //next sibling
			showOthers: true,
			weekNumbers: true,
			//onUpdate: function(){alert('1');}
			showsTime: true
		});
		jQuery("#edate").change(function(){
			if(!validateInputDate(jQuery("#edate").val()))
			{
				jQuery("#edate").val('{$s.edate|escape:html}');
				alert("时间格式不正确,正确的格式为:2009-06-10 10:59");
			}
		});
	});
</script>
<div class="form-div">
    <FORM name="searchForm" action="" METHOD='get'>
    <input type='hidden' name="controller" value="log"/>
    <input type='hidden' name="action" value="userlog"/>

<img src="./images/icon_search.gif" width="26" height="22" border="0" alt="SEARCH" /> 
用户名: <input type="text" name="username" size='28' value='{$s.username|escape:html}' />&nbsp;&nbsp;<a href="javascript:showNotice('noticeSearch');" title="帮助信息"><img src="./images/notice.gif" width="16" height="16" border="0" title="帮助信息"></a>&nbsp;&nbsp;&nbsp;&nbsp;
日志标题: <input type="text" name="ltype" size='28' value="{$s.ltype|escape:html}" />

<div style='padding: 5px 20px 2px 29px;'/>
开始时间: <input type="text" id="sdate" name="sdate" size='17' value='{$s.sdate|escape:html}' /> <img src="./images/calendar2.gif"> &nbsp;&nbsp;
截止时间: <input type="text"id="edate" name="edate"  size='17' value='{$s.edate|escape:html}' /> <img src="./images/calendar2.gif" />&nbsp;&nbsp;&nbsp;&nbsp;
网络地址: <input type="text" name="ipaddr" size='16' value="{$s.ipaddr|escape:html}" />
<input style='margin-left:20px' type="submit" value=" 开始查询 " class="button" /> 

<span class="notice-span" style='line-height:18px;padding:8px 0px 2px 20px;color:#669900' 
id="noticeSearch">默认查询当天产生的日志, 可根据需要自行指定时间.<br/>
所有查询条件都是可组合的过滤条件. 可以一次选择多个进行组合过滤 <br/>
用户名支持模糊搜索, 并且可以输入多个(逗号分隔), 例: <b><font color=red>Dummy,Dummy1*</font></b><br/>
时间格式为:YYYY-MM-DD HH:ii,例:2009-06-10 10:59</span>
</div>
</FORM>
</div>
<div class="list-div" id="listDiv">
<form method="POST" name="listForm">
<table cellspacing='1' cellpadding='3' id='list-table'><tr>
	<th>编号</th>
	<th>用户名</th>
	<th>日志标题</th>
	<th>控制器</th>
	<th>行为器</th>
	<th>IP</th>
	<th>时间</th>
	<th>操作</th>
</tr>
{foreach from=$aLogList item=info key=k}
<tr>
	<td align="center">{$info.entry}</td>
	<td align="center">{$info.username|escape:html}</td>
	<td align="center">{$info.title|escape:html}</td>
	<td align="center">{$info.controller|escape:html}</td>
	<td align="center">{$info.actioner|escape:html}</td>
	<td align="center">{$info.clientip|escape:html}</td>
	<td align="center">{$info.times}</td>
	<td align="center"><a href="./?controller=log&action=userlogview&id={$info.entry}">查看</a></td>
</tr>
{foreachelse}
    <tr><td class="no-records" colspan="10">无相关数据</td></tr>
{/foreach}
</table>
</form>
<table id="page-table" cellspacing="0"><tr><td align="right" nowrap="true">
<div style='padding-right:30px; padding-top:6px;'>{$pages}</div></td></tr></table>

</div>



<script language="JavaScript">
{literal}
function showNotice(objId)
{
    var obj = document.getElementById(objId);

    if (obj)
    {
        if (obj.style.display != "block")
        {
            obj.style.display = "block";
        }
        else
        {
            obj.style.display = "none";
        }
    }
}
if (document.getElementById("listDiv"))
{
  document.getElementById("listDiv").onmouseover = function(e)
  {
    obj = Utils.srcElement(e);

    if (obj)
    {
      if (obj.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode;
      else if (obj.parentNode.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode.parentNode;
      else return;

      for (i = 0; i < row.cells.length; i++)
      {
        if (row.cells[i].tagName != "TH") row.cells[i].style.backgroundColor = '#EEF8F9';
      }
    }

  }

  document.getElementById("listDiv").onmouseout = function(e)
  {
    obj = Utils.srcElement(e);

    if (obj)
    {
      if (obj.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode;
      else if (obj.parentNode.parentNode.tagName.toLowerCase() == "tr") row = obj.parentNode.parentNode;
      else return;

      for (i = 0; i < row.cells.length; i++)
      {
          if (row.cells[i].tagName != "TH") row.cells[i].style.backgroundColor = '#FFF';
      }
    }
  }
}

{/literal}
</script>
{include file="pagefooter.html"}